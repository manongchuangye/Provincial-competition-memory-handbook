1、【实操题】基础环境配置（2分）

使用提供的用户名密码，登录提供的OpenStack私有云平台，在当前租户下，使用CentOS7.9镜像，创建两台云主机，云主机类型使用4vCPU/12G/100G_50G类型。当前租户下默认存在一张网卡，自行创建第二张网卡并连接至controller和compute节点（第二张网卡的网段为10.10.X.0/24，X为工位号，不需要创建路由）。自行检查安全组策略，以确保网络正常通信与ssh连接，然后按以下要求配置服务器：

（1）设置控制节点主机名为controller，设置计算节点主机名为compute；

（2）修改hosts文件将IP地址映射为主机名；

完成后提交控制节点的用户名、密码和IP地址到答题框。

```

```



2、【实操题】Yum源配置（2分）

使用提供的http服务地址，在http服务下，存在centos7.9和iaas的网络yum源，使用该http源作为安装iaas平台的网络源。分别设置controller节点和compute节点的yum源文件http.repo。完成后提交控制节点的用户名、密码和IP地址到答题框。

```

```



3、【实操题】配置无秘钥ssh（2分）

配置controller节点可以无秘钥访问compute节点，配置完成后，尝试ssh连接compute节点的hostname进行测试。完成后提交controller节点的用户名、密码和IP地址到答题框。



4、【实操题】基础安装（2分）

在控制节点和计算节点上分别安装openstack-iaas软件包，根据表2配置两个节点脚本文件中的基本变量（配置脚本文件为/etc/openstack/openrc.sh）。

表2 云平台配置信息

| 服务名称         | 变量               | 参数/密码 |
| ---------------- | ------------------ | --------- |
| Mysql            | root               | 000000    |
| Keystone         | 000000             |           |
| Glance           | 000000             |           |
| Nova             | 000000             |           |
| Neutron          | 000000             |           |
| Heat             | 000000             |           |
| Zun              | 000000             |           |
| Keystone         | DOMAIN_NAME        | demo      |
| Admin            | 000000             |           |
| Rabbit           | 000000             |           |
| Glance           | 000000             |           |
| Nova             | 000000             |           |
| Neutron          | 000000             |           |
| Heat             | 000000             |           |
| Zun              | 000000             |           |
| Neutron          | Metadata           | 000000    |
| External Network | eth1（以实际为准） |           |

完成后提交控制节点的用户名、密码和IP地址到答题框。





5、【实操题】数据库安装与调优（2分）

在controller节点上使用iaas-install-mysql.sh 脚本安装Mariadb、Memcached、RabbitMQ等服务。安装服务完毕后，修改/etc/my.cnf文件，完成下列要求：

1.设置数据库支持大小写；

2.设置数据库缓存innodb表的索引，数据，插入数据时的缓冲为4G；

完成后提交控制节点的用户名、密码和IP地址到答题框。

```

```

6、【实操题】Keystone服务安装与使用（2分）

在controller节点上使用iaas-install-keystone.sh脚本安装Keystone服务。安装完成后，使用相关命令，创建用户chinaskill，密码为000000。完成后提交控制节点的用户名、密码和IP地址到答题框。

```

```



7、【实操题】Glance安装与使用（2分）

在controller节点上使用iaas-install-glance.sh脚本安装glance 服务。使用命令将提供的cirros-0.3.4-x86_64-disk.img镜像（该镜像在HTTP服务中，可自行下载）上传至平台，命名为cirros，并设置最小启动需要的硬盘为10G。完成后提交控制节点的用户名、密码和IP地址到答题框。

```

```



8、【实操题】Nova安装与优化（2分）

在controller节点和compute节点上分别使用iaas-install-placement.sh脚本、iaas-install-nova -controller.sh脚本、iaas-install-nova-compute.sh脚本安装Nova服务。安装完成后，请修改nova相关配置文件，解决因等待时间过长而导致虚拟机启动超时从而获取不到IP地址而报错失败的问题。配置完成后提交controller点的用户名、密码和IP地址到答题框。

```

```



9、【实操题】Neutron安装（2分）

使用提供的脚本iaas-install-neutron-controller.sh和iaas-install-neutron-compute.sh，在controller和compute节点上安装neutron服务。完成后提交控制节点的用户名、密码和IP地址到答题框。

```

```



10、【实操题】Doshboard安装（2分）

在controller节点上使用iaas-install-dashboad.sh脚本安装dashboad服务。完成后提交控制节点的用户名、密码和IP地址到答题框。

```

```





11、【实操题】Swift安装（2分）

在控制节点和计算节点上分别使用iaas-install-swift-controller.sh和iaas-install-swift-compute.sh脚本安装Swift服务。完成后提交控制节点的用户名、密码和IP地址到答题框。

```

```





12、【实操题】Cinder创建硬盘（2分）

在控制节点和计算节点分别使用iaas-install-cinder-controller.sh、iaas-install-cinder-compute.sh脚本安装Cinder服务，请在计算节点，对块存储进行扩容操作，即在计算节点再分出一个5G的分区，加入到cinder块存储的后端存储中去。完成后提交计算节点的用户名、密码和IP地址到答题框。

```

```



13、【实操题】Barbican服务安装与使用（2分）

使用iaas-install-barbican.sh脚本安装barbican服务，安装服务完毕后，使用openstack命令创建一个名为secret01的密钥，创建完成后提交控制节点的用户名、密码和IP地址到答题框。

```

```



14、【实操题】manila安装（2分）

在控制和计算节点上分别使用iaas-install-manila-controller.sh和iaas-install-manila-compute.sh脚本安装manila服务。安装服务后创建default_share_type共享类型（不使用驱动程序支持），接着创建一个大小为2G的共享存储名为share01。最后提交控制节点的用户名、密码和IP地址到答题框。

```

```





15、【实操题】Cloudkitty服务安装与使用（2分）

使用iaas-install-cloudkitty.sh脚本安装cloudkitty服务，安装完毕后，启用hashmap评级模块。设置完成后提交控制节点的用户名、密码和IP地址到答题框。

```

```





16、【实操题】OpenStack平台内存优化（2分）

搭建完OpenStack平台后，关闭系统的内存共享，打开透明大页。完成后提交控制节点的用户名、密码和IP地址到答题框。

```

```



17、【实操题】OpenStack Glance镜像压缩（2分）

使用自行搭建的OpenStack平台。在HTTP服务中存在一个镜像为CentOS7.5-compress.qcow2的镜像，请使用qemu相关命令，对该镜像进行压缩，压缩后的镜像命名为chinaskill-js-compress.qcow2并存放在/root目录下。完成后提交controller点的用户名、密码和IP地址到答题框。

```

```





18、【实操题】修改文件句柄数（2分）

Linux服务器大并发时，往往需要预先调优Linux参数。默认情况下，Linux最大文件句柄数为1024个。当你的服务器在大并发达到极限时，就会报出“too many open files”。创建一台云主机，修改相关配置，将控制节点的最大文件句柄数永久修改为65535。配置完成后提交controller点的用户名、密码和IP地址到答题框。

```

```





19、【实操题】OpenStack参数调优（2分）

OpenStack各服务内部通信都是通过RPC来交互，各agent都需要去连接RabbitMQ；随着各服务agent增多，MQ的连接数会随之增多，最终可能会到达上限，成为瓶颈。使用自行搭建的OpenStack私有云平台，分别通过用户级别、系统级别、配置文件来设置RabbitMQ服务的最大连接数为10240，配置完成后提交修改节点的用户名、密码和IP地址到答题框。

```

```



20、【实操题】Linux系统调优-防止SYN攻击（2分）

修改controller节点的相关配置文件，开启SYN cookie，防止SYN洪水攻击。完成后提交controller节点的用户名、密码和IP地址到答题框

```

```





21、【实操题】OpenStack开放镜像权限（2分）

使用OpenStack私有云平台，在OpenStack平台的admin项目中使用cirros-0.3.4-x86_64-disk.img镜像文件创建名为glance-cirros的镜像，通过OpenStack命令将glance-cirros镜像指定demo项目进行共享使用。配置完成后提交controller点的用户名、密码和IP地址到答题框。

```

```



22、【实操题】glance对接cinder后端存储（2分）

在自行搭建的OpenStack平台中修改相关参数，使glance可以使用cinder作为后端存储，将镜像存储于cinder卷中。使用cirros-0.3.4-x86_64-disk.img文件创建cirros-image镜像存储于cirros-cinder卷中，通过cirros-image镜像使用cinder卷启动盘的方式进行创建虚拟机。完成后提交修改节点的用户名、密码和IP地址到答题框。

```

```



23、【实操题】OpenStack Nova清除缓存（2分）

在OpenStack平台的一台计算节点创建虚拟机，若是第一次在该节点创建次虚拟机，会先将镜像文件复制到该计算节点目录/var/lib/nova/instances/_base。长期下来，该目录会占用比较大的磁盘空间而要清理。可以通过修改nova的配置文件来自动清理该缓存目录，即在该节点没有使用某镜像启动的云主机，那么这个镜像在过一定的时间后会被自动删除。配置完成后提交改动节点的用户名、密码和IP地址到答题框。

```

```





24、【实操题】Python运维开发：基于OpenStack Restful API实现镜像上传（2分）

使用OpenStack all-in-one镜像，创建OpenStack Python运维开发环境。云主机的用户/密码为：“root/Abc@1234”，OpenStack的域名/账号/密码为：“demo/admin/000000”。

提示说明：python脚本文件头建议加入“#encoding:utf-8”避免编码错误；测试脚本代码用python3命令执行与测试。

在controller节点的/root目录下创建api_image_manager.py脚本，编写python代码对接OpenStack API，完成镜像的创建与上传。创建之前查询是否存在“同名镜像”，如果存在先删除该镜像。

（1）创建镜像：要求在OpenStack私有云平台中上传镜像cirros-0.3.4-x86_64-disk.img，名字为cirros001，disk_format为qcow2，container_format为bare。

（2）查询镜像：查询cirros001的详细信息，并以json格式文本输出到控制台。

完成后提交OpenStack Python运维开发环境Controller节点的IP地址，用户名和密码提交。

```

```



25、【实操题】Python运维开发：基于Openstack Python SDK实现云主机创建（2分）

使用已建好的OpenStack Python运维开发环境，在/root目录下创建sdk_server_manager.py脚本，使用python-openstacksdk Python模块，完成云主机的创建和查询。创建之前查询是否存在“同名云主机”，如果存在先删除该镜像。

（1）创建1台云主机：云主机信息如下：

云主机名称如下：server001

镜像文件：cirros-0.3.4-x86_64-disk.img

云主机类型：m1.tiny

网络等必要信息自己补充。

（2）查询云主机：查询云主机server001的详细信息，并以json格式文本输出到控制台。

完成后提交OpenStack Python运维开发环境 Controller节点的IP地址，用户名和密码提交。

```

```





1、【实操题】平台部署--部署容器云平台（2分）

登录OpenStack私有云平台，使用CentOS7.9镜像创建两台云主机，使用kubeeasy工具完成Kubernetes 1.22.1集群的搭建。

完成后提交master节点的用户名、密码和IP到答题框。



2、【实操题】平台部署--部署Istio服务网格（2分）

在Kubernetes集群上完成Istio服务网格环境的安装。

完成后提交master节点的用户名、密码和IP到答题框。



3、【实操题】平台部署--部署KubeVirt虚拟化



4、【实操题】平台部署--部署Harbor仓库及Helm包管理工具（2分）

在master节点上完成Harbor镜像仓库及Helm包管理工具的部署。

完成后提交master节点的用户名、密码和IP到答题框。





5、【实操题】容器化Memcached服务（2分）

在master节点/root/DjangoBlog目录下编写Dockerfile-memcached文件构建blog-memcached:v1.0镜像，具体要求如下：（需要用到的软件包：Django.tar.gz）

（1）基础镜像：centos:7.9.2009；

（2）完成memcached服务的安装；

（3）声明端口：11211；

（4）设置服务开机自启。

完成后构建镜像，并提交master节点的用户名、密码和IP地址到答题框。

```
[root@master ~]# cd DjangoBlog/
[root@master DjangoBlog]# vi local.repo 
[yum]
name=yum
baseurl=file:///root/yum
gpgcheck=0
enabled=1

[root@master DjangoBlog]# vi Dockerfile-memcached
FROM centos:centos7.9.2009
MAINTAINER Chinaskills
RUN rm -rf /etc/yum.repos.d/*
COPY local.repo /etc/yum.repos.d/
COPY yum /root/yum
RUN yum install libevent libevent-devel -y
RUN yum install memcached -y
EXPOSE 11211
ENTRYPOINT /usr/bin/memcached -u root
```

6、【实操题】容器化Mariadb服务（2分）

在master节点/root/DjangoBlog目录下编写Dockerfile-mariadb文件构建blog-mysql:v1.0镜像，具体要求如下：（需要用到的软件包：Django.tar.gz）

（1）基础镜像：centos:7.9.2009；

（2）安装MariaDB服务并设置root用户的密码为root；

（3）创建数据库djangoblog并将sqlfile.sql导入该数据库；

（4）声明端口：3306；

（5）设置服务开机自启。

完成后构建镜像，并提交master节点的用户名、密码和IP地址到答题框。

```

```

7、【实操题】容器化前端服务

```

```

8、【实操题】容器化Blog服务（2分）



在master节点/root/DjangoBlog目录下编写Dockerfile-blog文件构建blog-service:v1.0镜像，具体要求如下：（需要用到的软件包：Django.tar.gz）

（1）基础镜像：centos:7.9.2009；

（2）安装Python3.6环境；

（3）使用pip3工具离线安装requirements.txt中的软件包；

（4）安装DjangoBlog服务；

（5）声明端口：8000；

（6）设置DjangoBlog服务开机自启。

完成后构建镜像，并提交master节点的用户名、密码和IP地址到答题框。

```

```



9、【实操题】编排部署博客系统（3分）

在master节点/root/DjangoBlog目录下编写docker-compose.yaml文件，具体要求如下：

（1）容器1名称：blog-memcached；镜像：blog-memcached:v1.0；端口映射：11211:11211；

（2）容器2名称：blog-mysql；镜像：blog-mysql:v1.0；端口映射：3306:3306；

（3）容器3名称：blog-nginx；镜像：blog-nginx:v1.0；端口映射：80:8888；

（4）容器4名称：blog-service；镜像：blog-service:v1.0；端口映射：8000:8000。

完成后编排部署该博客系统，并提交master节点的用户名、密码和IP地址到答题框。

```

```



10、【实操题】Pod管理--创建Pod（2分）

在default命名空间下使用nginx:latest镜像创建一个QoS类为Guaranteed的Pod，名称为qos-demo。

完成后提交master节点的IP地址、用户名和密码到答题框。

```

```



11、【实操题】安全管理--配置Pod安全上下文（2分）

使用busybox镜像启动一个名为context-demo的Pod，为该Pod配置安全上下文，要求容器内以用户1000和用户组3000来运行所有进程，并在启动时执行“sleep 1h”命令。

完成后提交master节点的IP地址、用户名和密码到答题框。

```

```

12、【实操题】CRD管理--创建自定义资源类型（2分）



在Kubernetes集群中自定义一种资源类型Student，API为stable.example.com/v1，单数形式为student，复数形式为students，简写为stu，作用域为命名空间级，然后在default命名空间下创建一个名为exam的Student对象。

完成后提交master节点的IP地址、用户名和密码到答题框。（000）

```
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: students.stable.example.com
spec:
  group: stable.example.com
  versions:
  - name: v1
    storage: true
    served: true
    schema:  
      openAPIV3Schema:
        type: object
  scope: Namespaced
  names:
    kind: Student
    plural: students
    singular: student
    shortNames:
    - stu
```

13、【实操题】解析管理--添加主机别名到Pod（2分）

使用nginx镜像在default命名空间下创建一个名为nginx的Pod，并在Pod的/etc/hosts中添加IP地址127.0.0.1与chinaskills的解析。

完成后提交master节点的IP地址、用户名和密码到答题框。

```
apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    run: nginx
  name: nginx
spec:
  hostAliases:
  - ip: "127.0.0.1"
    hostnames:
    - "chinaskill"
  containers:
  - image: nginx:latest
    name: nginx
    ports:
    - containerPort: 80
    resources: {}
  dnsPolicy: ClusterFirst
  restartPolicy: Always
status: {}
```

14、【实操题】HPA管理--创建HPA规则（2分）

默认情况下HPA是无法调整伸缩灵敏度的，但不同的业务场景对伸缩灵敏度的要求不一样。要求在default命名空间下使用nginx镜像创建一个名为web的deployment，自定义HPA的伸缩灵敏度，为该deployment创建一个名为web的HPA，扩容时立即新增当前9倍数量的副本数，时间窗口为5s，伸缩范围为1--1000。例如一开始只有1个Pod，当CPU使用率超过80%时，Pod数量变化趋势为：1 → 10 → 100 → 1000。

完成后提交master节点的IP地址、用户名和密码到答题框。

```

```

15、【实操题】流量管理--创建Ingress Gateway（2分）

使用提供的软件包ServiceMesh.tar.gz将Bookinfo应用部署到default命名空间下，使用Istio Gateway可以实现应用程序从外部访问，请为Bookinfo应用创建一个名为bookinfo-gateway的网关，指定所有HTTP流量通过80端口流入网格，然后将网关绑定到虚拟服务bookinfo上。

完成后提交master节点的IP地址、用户名和密码到答题框。

```

```

16、【实操题】服务网格--创建基于用户身份的路由（2分）

创建一个名为reviews路由，要求来自名为Jason的用户的所有流量将被路由到服务reviews:v2。

完成后提交master节点的用户名、密码和IP到答题框。

```

```

17、【实操题】VM管理--创建VM（2分）

使用镜像fedora-virt:v1.0在default命名空间下创建一台vm，名称为vm-fedora，内存为1G。（0）

完成后提交master节点的IP地址、用户名和密码到答题框。

```

```

18、【实操题】存储与卷--创建emptyDisk卷（2分）

使用镜像fedora-virt:v1.0在default命名空间下创建一台vmi，名称为vmi-fedora，并使用emptyDisk卷为vmi挂载一块2G的磁盘。

完成后提交master节点的IP地址、用户名和密码到答题框。

```

```

二、容器云任务（当前任务共20道题目）



19、【实操题】Python运维开发：基于Kubernetes Restful API实现Deployment创建（2分）



在提供的OpenStack私有云平台上，使用k8s-python-dev镜像创建1台云主机，云主机类型使用4vCPU/12G内存/100G硬盘。该主机中已经默认安装了所需的开发环境，登录默认账号密码为“root/1DaoYun@2022”。

使用Kubernetes Restful API库，在/root目录下，创建api_deployment_manager.py文件，要求编写python代码，代码实现以下任务：

（1）编写Python程序实现Deployment资源的创建。Deployment配置信息如下。如果同名Deployment存在，先删除再创建。

（2）创建完成后，查询该Deployment的详细信息，执行结果控制台输出，以yaml格式展示。

创建Deployment 的yaml的配置如下：

apiVersion: apps/v1

kind: Deployment

metadata:

 name: nginx-deployment

 labels:

 app: nginx

spec:

 replicas: 3

 selector:

 matchLabels:

 app: nginx

 template:

 metadata:

 labels:

 app: nginx

 spec:

 containers:

 \- name: nginx

 image: nginx:1.15.4

 ports:

 \- containerPort: 80

```

```

20、【实操题】Python运维开发：基于Kubernetes Python SDK实现Job创建（2分）



在前面已建好的Kubernetes开发环境云平台上。使用Kubernetes python SDK的“kubernetes”Python库，在/root目录下，创建sdk_job_manager.py文件，要求编写python代码，代码实现以下任务：

（1）编写Python程序实现Job资源的创建。Job配置信息如下。如果同名Job存在，先删除再创建。

（2）创建完成后，查询该Job的详细信息，执行结果控制台输出，以json格式展示。

Job创建yaml的信息如下：

apiVersion: batch/v1

kind: Job

metadata:

 name: pi

spec:

 template:

 spec:

 containers:

 \- name: pi

 image: perl

 command: ["perl", "-Mbignum=bpi", "-wle", "print bpi(2000)"]

 restartPolicy: Never

 backoffLimit: 4

```

```

```
时间得分任务名称题目

2022-12-12 16:07:270二、容器云任务20、Python运维开发：基于Kubernetes Python SDK实现Job创建

2022-12-12 16:06:550二、容器云任务19、Python运维开发：基于Kubernetes Restful API实现Deployment创建

2022-12-12 16:04:430二、容器云任务18、存储与卷--创建emptyDisk卷

2022-12-12 15:57:150二、容器云任务17、VM管理--创建VM

2022-12-12 15:49:350二、容器云任务16、服务网格--创建基于用户身份的路由

2022-12-12 15:45:122二、容器云任务15、流量管理--创建Ingress Gateway

2022-12-12 15:24:080二、容器云任务14、HPA管理--创建HPA规则

2022-12-12 15:22:450二、容器云任务13、解析管理--添加主机别名到Pod

2022-12-12 15:14:160二、容器云任务12、CRD管理--创建自定义资源类型

2022-12-12 15:05:360二、容器云任务11、安全管理--配置Pod安全上下文

2022-12-12 14:46:110二、容器云任务10、Pod管理--创建Pod

2022-12-12 14:08:583二、容器云任务9、编排部署博客系统

2022-12-12 13:49:092二、容器云任务8、容器化Blog服务

2022-12-12 13:25:081二、容器云任务7、容器化前端服务

2022-12-12 13:16:342二、容器云任务6、容器化Mariadb服务

2022-12-12 13:06:202二、容器云任务5、容器化Memcached服务

2022-12-12 12:47:042二、容器云任务4、平台部署--部署Harbor仓库及Helm包管理工具

2022-12-12 12:24:462二、容器云任务3、平台部署--部署KubeVirt虚拟化

2022-12-12 12:22:120二、容器云任务2、平台部署--部署Istio服务网格

2022-12-12 12:19:042二、容器云任务1、平台部署--部署容器云平台

2022-12-12 11:58:360一、私有云任务25、Python运维开发：基于Openstack Python SDK实现云主机创建

2022-12-12 11:57:450一、私有云任务24、Python运维开发：基于OpenStack Restful API实现镜像上传

2022-12-12 11:57:200一、私有云任务23、OpenStack Nova清除缓存

2022-12-12 11:56:560一、私有云任务22、glance对接cinder后端存储

2022-12-12 11:56:280一、私有云任务21、OpenStack开放镜像权限

2022-12-12 11:56:010一、私有云任务20、Linux系统调优-防止SYN攻击

2022-12-12 11:55:380一、私有云任务19、OpenStack参数调优

2022-12-12 11:55:140一、私有云任务18、修改文件句柄数

2022-12-12 11:54:500一、私有云任务17、OpenStack Glance镜像压缩

2022-12-12 11:54:280一、私有云任务16、OpenStack平台内存优化

2022-12-12 11:53:570一、私有云任务15、Cloudkitty服务安装与使用

2022-12-12 11:53:310一、私有云任务14、manila安装

2022-12-12 11:53:040一、私有云任务13、Barbican服务安装与使用

2022-12-12 11:52:380一、私有云任务12、Cinder创建硬盘

2022-12-12 11:52:130一、私有云任务11、Swift安装

2022-12-12 11:51:480一、私有云任务10、Doshboard安装

2022-12-12 11:51:270一、私有云任务9、Neutron安装

2022-12-12 11:50:590一、私有云任务8、Nova安装与优化

2022-12-12 11:50:290一、私有云任务7、Glance安装与使用

2022-12-12 11:49:160一、私有云任务6、Keystone服务安装与使用

2022-12-12 11:48:020一、私有云任务5、数据库安装与调优

2022-12-12 11:46:580一、私有云任务4、基础安装

2022-12-12 11:45:190一、私有云任务3、配置无秘钥ssh

2022-12-12 11:43:460一、私有云任务2、Yum源配置

2022-12-12 11:42:280一、私有云任务1、基础环境配置
```

